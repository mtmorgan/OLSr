<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>OLSr Cache Management — cache_directory • OLSr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="OLSr Cache Management — cache_directory"><meta name="description" content="cache_directory() returns the on-disk location of
the cache used by OLSr.
cache_summary() reports the number and size of files
in the cache, the oldest file, etc.
cache_info() reports information about each file in
the cache.
cache() returns an object that can be used in cache
management."><meta property="og:description" content="cache_directory() returns the on-disk location of
the cache used by OLSr.
cache_summary() reports the number and size of files
in the cache, the oldest file, etc.
cache_info() reports information about each file in
the cache.
cache() returns an object that can be used in cache
management."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OLSr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a_introduction.html">Introduction to OLSr</a></li>
    <li><a class="dropdown-item" href="../articles/b_case_study_cxg.html">Case Study: CELLxGENE Ontologies</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mtmorgan/OLSr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>OLSr Cache Management</h1>
      <small class="dont-index">Source: <a href="https://github.com/mtmorgan/OLSr/blob/main/R/cache.R" class="external-link"><code>R/cache.R</code></a></small>
      <div class="d-none name"><code>cache.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>cache_directory()</code> returns the on-disk location of
the cache used by OLSr.</p>
<p><code>cache_summary()</code> reports the number and size of files
in the cache, the oldest file, etc.</p>
<p><code>cache_info()</code> reports information about each file in
the cache.</p>
<p><code>cache()</code> returns an object that can be used in cache
management.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cache_directory</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cache_summary</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cache_info</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cache</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cache_summary'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>for <code>print.cache_summary()</code>, an object returned by
`cache_summary().</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored by <code>print.cache_summary()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>cache_directory() returns the character(1) path to the
location of the cache on disk.</p>
<p><code>cache_summary()</code> returns a list with the following elements:</p><ul><li><p><code>directory</code>: the location of the cache, i.e., <code>cache_directory()</code>.</p></li>
<li><p><code>n_files</code>: the number of files in the cache.</p></li>
<li><p><code>cache_size</code>: the sum of file sizes in the cache.</p></li>
<li><p><code>largest_file</code>, <code>largest_size</code>: the largest file and its size in
the cache.</p></li>
<li><p><code>oldest_file</code>, <code>oldest_age</code>: the name and age (as a <code>difftime</code>
object) of the oldest (based on <code>ctime</code>) file in the path.</p></li>
<li><p><code>least_used_file</code>, <code>least_used_age</code>: the name and age of the file
that was modified least recently, based on <code>mtime</code>.</p></li>
</ul><p><code>print.cache_summary()</code> displays this information in a readable
way.</p>
<p><code>cache_info()</code> returns a tibble with columns summarizing</p><ul><li><p><code>file</code>: the file name of the cache entry. This is a hash, based
on the function and signature, of the cached object. It is not
easily possible to associate individual calls in <em>R</em> to file
names.</p></li>
<li><p><code>size</code> the size in bytes of the cached object.</p></li>
<li><p><code>mtime</code>, <code>ctime</code>, <code>atime</code>: the modification, creation and
last-access time of the file.</p></li>
</ul><p><code>cache()</code> returns an object defined in the cachem package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>OLSr uses an on-disk cache to improve performance and reliability.
Each query to the OLS server is cached on first use, so that
subsequent responses can be read from the local disk. This greatly
increases performance, and allows use of previously retrieved
resources when off-line.</p>
<p>A risk of using a cache is that the cache contains an 'old' version
of the response. Circumvent this risk by manually manipulating the
cache, e.g., removing objects that a known to be too old.</p>
<p>OLSr uses the memoise <a href="https://CRAN.R-project.org/package=memoise" class="external-link">https://CRAN.R-project.org/package=memoise</a>
and cachem <a href="https://CRAN.R-project.org/package=cachem" class="external-link">https://CRAN.R-project.org/package=cachem</a> packages to
implement the cache. The disk cache is implemented using cachem's
<code>cache_disk()</code> function using the default cache size (1 Gb) and
<code>"lsu"</code> ('least recently used') eviction policy. Objects remain in
the cache for 30 days.</p>
<p>The cache is created in a package-specific directory, located at
<code>cache_directory()</code>.</p>
<p>See the help page <code>?cache_disk</code> for information on using the object
returned by <code>cache()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">cache_directory</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/home/runner/.cache/R/OLSr"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cache_summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cache directory: /home/runner/.cache/R/OLSr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of files: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total cache size: 0 bytes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> largest file: 0 B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oldest file: 0 secs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> least used file: 0 secs  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cache_info</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 11 variables: file &lt;chr&gt;, size &lt;dbl&gt;, isdir &lt;lgl&gt;, mode &lt;octmode&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   mtime &lt;dttm&gt;, ctime &lt;dttm&gt;, atime &lt;dttm&gt;, uid &lt;int&gt;, gid &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   uname &lt;chr&gt;, grname &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cache objects created in the last 24 hours</span></span></span>
<span class="r-in"><span><span class="fu">cache_info</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mtime</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 11 variables: file &lt;chr&gt;, size &lt;dbl&gt;, isdir &lt;lgl&gt;, mode &lt;octmode&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   mtime &lt;dttm&gt;, ctime &lt;dttm&gt;, atime &lt;dttm&gt;, uid &lt;int&gt;, gid &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   uname &lt;chr&gt;, grname &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## remove the most recently modified object, forcing this to be recreated</span></span></span>
<span class="r-in"><span><span class="va">file_name</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">cache_info</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">mtime</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">cache_directory</span><span class="op">(</span><span class="op">)</span>, <span class="va">file_name</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cache</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;cache_disk&gt; &lt;cachem&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Methods:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     get(key, missing = missing_)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     set(key, value)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     exists(key)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     keys()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     remove(key)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reset()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     prune()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     size()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     destroy()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_destroyed(throw = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     info()</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Morgan, Chan Zuckerberg Initiative DAF CZF2019-002443, NIH NCI ITCR U24CA180996.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

